<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ title|default('CI/CD Demo') }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Inter font (lightweight, great readability). Remove if you prefer system font only. -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#005a70;            /* primary */
      --brand-ink:#0b2530;        /* deep text */
      --bg:#ffffff;
      --card:#ffffff;
      --muted:#6b7280;            /* gray-500 */
      --line:#e5e7eb;             /* gray-200 */
      --focus: 0 0 0 3px rgba(0,90,112,.25);
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1214;
        --card:#0f1a1d;
        --brand-ink:#d7e6ea;
        --muted:#9ca3af;
        --line:#203036;
      }
    }

    .alert { border-left: 4px solid var(--bar, #b91c1c); }
    .alert.success { --bar: #16a34a; }
    .alert.warning { --bar: #ca8a04; }
    .alert.error { --bar: #b91c1c; }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--brand-ink);
      line-height:1.55;
    }

    /* Header / nav */
    header {
      position: sticky; top: 0; z-index: 50;
      backdrop-filter: saturate(160%) blur(6px);
      background: color-mix(in oklab, var(--bg) 86%, transparent);
      border-bottom: 1px solid var(--line);
    }
    .nav-wrap{
      display:flex; align-items:center; gap:16px;
      padding:12px 20px; max-width:1100px; margin:0 auto;
    }
    .brand {
      font-weight:700; letter-spacing:.2px;
      color: var(--brand);
      padding-right:8px;
    }
    nav { display:flex; align-items:center; gap:12px; flex-wrap: wrap; }
    nav a {
      text-decoration:none; padding:8px 10px; border-radius:10px;
      color: var(--brand-ink);
    }
    nav a:hover, nav a[aria-current="page"]{
      background: color-mix(in oklab, var(--brand) 12%, transparent);
      color: var(--brand);
    }
    .spacer{ flex:1; }

    .badges { display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
    .badge {
      font-size:12px; padding:4px 8px; border-radius:999px;
      background: color-mix(in oklab, var(--brand) 10%, var(--card));
      border: 1px solid var(--line);
      color: var(--brand-ink);
      cursor: default;
      user-select: none;
    }
    .badge.clickable{ cursor:pointer; }
    .tooltip {
      position:absolute; transform:translateY(-6px);
      font-size:12px; color:var(--bg); background: var(--brand); padding:2px 6px; border-radius:6px;
      opacity:0; transition:.18s; pointer-events:none;
    }
    .badge-wrap{ position:relative; }

    /* Layout */
    main { max-width:1100px; margin: 24px auto; padding: 0 20px; }
    .section { margin: 18px 0 28px; }
    .h1 { font-size: clamp(22px, 2.6vw, 28px); font-weight:700; margin:0 0 10px;}
    .h2 { font-size: clamp(18px, 2.3vw, 22px); font-weight:600; margin:0 0 10px;}
    .muted { color: var(--muted); }

    /* Cards */
    .card {
      background: var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:18px;
      box-shadow: 0 1px 0 rgba(0,0,0,.02);
    }

    /* Forms / inputs */
    .row { display:flex; gap:12px; flex-wrap: wrap; }
    .input {
      flex: 1 1 280px;
      padding:10px 12px; border-radius:12px; border:1px solid var(--line);
      background: var(--bg); color: var(--brand-ink);
      outline:none;
    }
    .input::placeholder{ color: color-mix(in oklab, var(--muted) 80%, transparent); }
    .input:focus{ box-shadow: var(--focus); border-color: color-mix(in oklab, var(--brand) 35%, var(--line)); }

    .btn {
      appearance:none; border:1px solid var(--brand); background: var(--brand); color:#fff;
      padding:10px 14px; border-radius:12px; font-weight:600; cursor:pointer;
    }
    .btn:hover{ filter:brightness(1.05); }
    .btn.secondary{
      background: transparent; color: var(--brand); border-color: color-mix(in oklab, var(--brand) 55%, var(--line));
    }
    .btn:focus-visible{ box-shadow: var(--focus); }

    /* Lists */
    ul.clean { list-style:none; padding-left:0; margin:0; }
    .item {
      padding:12px 0; border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; gap:10px;
    }
    .item:last-child{ border-bottom:none; }

    /* Timeline (releases) */
    .timeline{
      position:relative; padding-left:22px;
    }
    .timeline:before{
      content:""; position:absolute; left:8px; top:0; bottom:0; width:2px; background: var(--line);
    }
    .t-item{
      position:relative; margin:0 0 14px 0; padding-left:6px;
    }
    .t-item:before{
      content:""; position:absolute; left:-16px; top:.45em; width:10px; height:10px; border-radius:999px;
      background: var(--brand);
      box-shadow: 0 0 0 3px color-mix(in oklab, var(--brand) 18%, transparent);
    }

    footer {
      border-top:1px solid var(--line);
      margin-top:36px;
      padding:16px 20px;
      color: var(--muted);
      font-size: 13px;
      text-align:center;
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-wrap">
      <div class="brand">CI/CD Demo</div>

      <nav aria-label="Primary">
        <a href="{{ url_for('home') }}"
           aria-current="{{ 'page' if request.path == url_for('home') else 'false' }}">Home</a>
        <a href="{{ url_for('about') }}"
           aria-current="{{ 'page' if request.path == url_for('about') else 'false' }}">About</a>
        <a href="{{ url_for('releases') }}"
           aria-current="{{ 'page' if request.path == url_for('releases') else 'false' }}">Releases</a>
        <a href="{{ url_for('notes') }}"
           aria-current="{{ 'page' if request.path == url_for('notes') else 'false' }}">Notes</a>
        <a class="btn secondary" href="/metrics" target="_blank" rel="noopener">Metrics</a>
      </nav>

      <div class="spacer"></div>

      <div class="badges">
        <span class="badge">ENV&nbsp;{{ env }}</span>
        <span class="badge">VER&nbsp;{{ version }}</span>

        <!-- Click to copy short SHA -->
        <span class="badge-wrap">
          <span id="shaBadge" class="badge clickable" title="Click to copy SHA">SHA&nbsp;{{ sha[:7] }}</span>
          <span id="shaTip" class="tooltip">Copied!</span>
        </span>
      </div>
    </div>
  </header>

  <main>
    {% block content %}{% endblock %}
  </main>

  <footer>
    © CI/CD Pipeline Demo • Deployed automatically with GitHub Actions
  </footer>

  <script>
    // Simple copy-to-clipboard for SHA
    const shaBadge = document.getElementById('shaBadge');
    const tip = document.getElementById('shaTip');
    if (shaBadge){
      shaBadge.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(shaBadge.textContent.replace('SHA','').trim());
          tip.style.opacity = 1;
          setTimeout(()=> tip.style.opacity = 0, 900);
        } catch(e){}
      });
    }
  </script>
</body>
</html>
